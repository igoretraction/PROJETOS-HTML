<style>
    /* Estilos do Cupom */
    .cupom-lateral {
        max-width: 440px;
        width: 100%;
        margin: 50px auto;
        /* Centralizei para facilitar a visualização no teste */
        padding: 16px;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        font-family: 'Montserrat', sans-serif;
        display: flex;
        justify-content: space-between;
        align-items: center;
        min-height: 100px;
        box-sizing: border-box;
        gap: 4px;
        position: relative;
    }

    .cupom-lateral .texto {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .cupom-lateral .texto .kicker {
        font-size: 13px;
        color: #222;
        text-transform: uppercase;
        margin-bottom: 4px;
        letter-spacing: 0.2px;
    }

    .cupom-lateral .texto .kicker strong {
        color: #000;
        font-size: 1rem;
        font-weight: 800;
    }

    .cupom-lateral .texto .titulo {
        font-size: 14px;
        color: #555;
        line-height: 1.3;
        margin-bottom: 4px;
    }

    /* Área do Código */
    .cupom-lateral .codigo-area {
        position: relative;
        width: 140px;
        height: 50px;
        background: #f4f4f4;
        border: 1px dashed #aaa;
        border-radius: 8px;
        overflow: hidden;
        cursor: crosshair;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .cupom-lateral .codigo-texto {
        font-weight: 800;
        font-size: 1.1rem;
        color: #333;
        user-select: none;
        z-index: 1;
    }

    .cupom-lateral canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 2;
        touch-action: none;
    }

    .cupom-lateral .copiado {
        position: absolute;
        bottom: -25px;
        right: 16px;
        font-size: 0.75rem;
        color: #28a745;
        font-weight: 600;
        display: none;
    }
</style>

<p>
    <script>
        $(document).ready(function () {

            const htmlCupom = `
            <div id="cupom-container" class="cupom-lateral">
                <div class="texto">
                    <div class="kicker"><strong>PRIMEIRA VEZ AQUI? </strong><br>10% de Desconto</div>
                    <div class="titulo">Válido somente para a primeira compra*</div>
                </div>
                
                <div id="codigo-wrapper" class="codigo-area" title="RASPE PARA REVELAR O CUPOM">
                    <span class="codigo-texto">BEMVINDO</span>
                    <canvas id="canvasRevelacao"></canvas>
                </div>
                
                <div id="copiado-msg" class="copiado">✔ Copiado!</div>
            </div>`;

            // --- ALTERAÇÃO AQUI ---
            // Em vez de .insertBefore, usamos .appendTo ou .prependTo no body
            $(htmlCupom).appendTo(".info-garantia");


            // Lógica do Canvas (Revelação Permanente)
            function initRevealEffect() {
                const canvas = document.getElementById('canvasRevelacao');
                const wrapper = document.getElementById('codigo-wrapper');

                if (!canvas) return;

                const ctx = canvas.getContext('2d', { willReadFrequently: true });

                canvas.width = wrapper.offsetWidth;
                canvas.height = wrapper.offsetHeight;

                // Capa
                ctx.fillStyle = '#dbeafe';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Texto
                ctx.font = 'bold 16px sans-serif';
                ctx.fillStyle = '#000000';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('RASPE AQUI!', canvas.width / 2, canvas.height / 2);

                ctx.globalCompositeOperation = 'destination-out';

                function erase(x, y) {
                    ctx.beginPath();
                    ctx.arc(x, y, 25, 0, Math.PI * 2, false);
                    ctx.fill();
                }

                const handleMove = (e) => {
                    e.preventDefault();
                    const rect = canvas.getBoundingClientRect();
                    let x, y;

                    if (e.touches && e.touches.length > 0) {
                        x = e.touches[0].clientX - rect.left;
                        y = e.touches[0].clientY - rect.top;
                    } else {
                        x = e.clientX - rect.left;
                        y = e.clientY - rect.top;
                    }
                    erase(x, y);
                };

                canvas.addEventListener('mousemove', handleMove);
                canvas.addEventListener('touchmove', handleMove, { passive: false });
            }

            // Aguarda um pouquinho para garantir que o elemento foi inserido no DOM
            setTimeout(initRevealEffect, 100);

            // Clique para copiar
            $("body").on("click", "#codigo-wrapper", function () {
                const codigo = "BEMVINDO";
                navigator.clipboard.writeText(codigo).then(() => {
                    $("#copiado-msg").fadeIn(200).delay(1500).fadeOut(200);
                    $(this).css('border-color', '#28a745');
                    setTimeout(() => {
                        $(this).css('border-color', '#aaa');
                    }, 300);
                });
            });

        });
    </script>
</p>